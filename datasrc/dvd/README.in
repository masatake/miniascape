About
=====================

This is a collection of configuration files to serve installation tree,
actually the contents in DVD iso images for vms.


Setup
=====================

autofs
---------------------

1. Add auto.iso entry in /etc/auto.master:

::

@WWWDATADIR@    /etc/auto.iso


2. Edit /etc/auto.iso in accordance with your environment


httpd
---------------------

Modify /etc/httpd/conf.d/miniascape-datasrc-dvd.conf as needed.
Please note that configuration must be consistent with autofs.


nginx
---------------------

Modify /etc/nginx/conf.d/m/miniascape-datasrc-dvd.conf as needed.
Please note that configuration must be consistent with autofs.


How to make a DVD rpm
==========================

I recommend you to make packages of DVD iso images instead just copying DVD
isos into @ISODATADIR@.

To make a DVD rpm, go through like the followings:

1. create a workdir and a dir in it to save DVD iso image
2. put DVD iso image in that dir
3. make a package with using xpack.py


xpack.py is available from: https://github.com/ssato/rpmkit/


Here is an example session to make and install a dvd rpm:
::

  ssato@localhost% mkdir /tmp/dvdrpms
  ssato@localhost% cd /tmp/dvdrpms
  ssato@localhost% mkdir -p srv/isos
  ssato@localhost% cp /var/tmp/rhel-server-5.6-i386-dvd.iso srv/isos
  ssato@localhost% curl -s -O https://github.com/ssato/rpmkit/raw/master/xpack.py
  ssato@localhost% echo /tmp/t/srv/isos/rhel-server-5.6-i386-dvd.iso | \\
  > python xpack.py -n rhel-server-5-6-i386-dvd-iso -w ./0 \\
  > --destdir /tmp/t/ --upto build --no-mock -
  ...(snip)...
  ssato@localhost% rpm -qlp 0/rhel-server-5-6-i386-dvd-iso-0.1/rhel-server-5-6-i386-dvd-iso-0.1-1.fc14.noarch.rpm
  /srv/isos/rhel-server-5.6-i386-dvd.iso
  /usr/share/doc/rhel-server-5-6-i386-dvd-iso-0.1
  /usr/share/doc/rhel-server-5-6-i386-dvd-iso-0.1/MANIFEST
  /usr/share/doc/rhel-server-5-6-i386-dvd-iso-0.1/README
  ssato@localhost% sudo yum localinstall -y --nogpgcheck 0/rhel-server-5-6-i386-dvd-iso-0.1-1.fc14.noarch.rpm
  [sudo] password for ssato:
  Loaded plugins: langpacks, presto, refresh-packagekit
  Setting up Local Package Process
  Examining 0/rhel-server-5-6-i386-dvd-iso-0.1-1.fc14.noarch.rpm: rhel-server-5-6-i386-dvd-iso-0.1-1.fc14.noarch
  Marking 0/rhel-server-5-6-i386-dvd-iso-0.1-1.fc14.noarch.rpm to be installed
  ...(snip) ...
  Installed:
    rhel-server-5-6-i386-dvd-iso.noarch 0:0.1-1.fc14

  Complete!
  ssato@localhost% 




