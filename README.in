====================
@PACKAGE@
====================

WARNING: @PACKAGE@ is in pre-alpha state and will heavily udpate day by day, so
it may not work in your environment or might cause trouble. TRY IT IN YOUR OWN
RISK, PLEASE.



@PACKAGE@ is a collection of configurations and data to setup libvirt based
virtualization guests environment quickly.

Main objects are

 * Make network configuration for virtualization guests much easier.
   (pre-defined libvirt networks and DHCP configs)

 * Does not require expensive high-performance servers. 
   I try to make it installable on my vaio note pc
   (vaio type-P: Atom Z540, 64GB SSD, 2 G RAM)

 * Do not intend to replace other feature rich software such like
   RHEV, cobbler, etc.


Files
====================

 * libvirt network definitions: /etc/@PACKAGE@/libvirt/*.xml
 * dnsmasq configs: /etc/@PACKAGE@/dnsmasq/*.conf
 * dnsmasq init scripts (per libvirt networks): /etc/rc.d/init.d/@PACKAGE@-$netname
 * misc tools: /usr/libexec/@PACKAGE@/*


Prerequisites
====================

 * virsh in libvirt
 * dnsmasq (must be installed if libvirt is installed)


Build
====================

 [autoreconf -vfi]
 ./configure


Installation
====================

 make 
 make install


Create [S]RPM
-----------------------

 make rpm | make srpm


Actions needed after post/pre installation, update and uninstallation
------------------------------------------------------------------------

Post installation
^^^^^^^^^^^^^^^^^^^^^

Run "/usr/libexec/@PACKAGE@/net-install.py" to install the followings
 
  * /etc/libvirt/qemu/networks/net-{1,2,3}.xml


Also, you need to virsh net-start net-{1,2,3} to start networks actually.

[NOTE: If you installing @PACKAGE@ from RPM. The above operation is
automatically performed in post-install section so that you don't have to do
the above at all.]


Post uninstallation
^^^^^^^^^^^^^^^^^^^^^^^

The networks for virtualization environments (net-1, net-2 and net-3) are not
uninstalled automatically.  So, you need to uninstall by yourself if you want
to eliminate them entirely.

 1. Shutdown all of virtualization guests using these networks
 2. Shutdown and uninstall networks like the followings:

  * "for i in 1 2 3; do virsh destroy net-$i; done"
  * "for i in 1 2 3; do virsh undefine net-$i; done"


Pre/Post update
^^^^^^^^^^^^^^^^^^^^^
Pre: perform operations for post-uninstallation

Post: perform operations for post-installation


TODO
=====================

 * Make network definitions more configurable
 * Merge ISC DHCP and bind backend as an option instead of dnsmasq
 * Merge build (installation and packaging) scripts from vdbs: On going
 * Converter: VMDK + VMX -> QCOW2 + libvirt domain XML
 * Wrote more test codes for scripts
 * Restructure and split tools and reference data
 * Make http service daemon configurable

 * Eliminate GNU extensions in Makefile-s:

data/dnsmasq/Makefile.am:12: `%'-style pattern rules are a GNU make extension
data/libvirt/Makefile.am:6: `%'-style pattern rules are a GNU make extension

 * Handle rpmlint errors (see below)

[rpmlint errors/warnings]

ssato@localhost% rpmlint miniascape-0.1-1.fc11.noarch.rpm
miniascape.noarch: W: conffile-without-noreplace-flag /etc/miniascape/dnsmasq/net-2.conf
miniascape.noarch: W: conffile-without-noreplace-flag /etc/miniascape/libvirt/networks/net-2.xml
miniascape.noarch: W: conffile-without-noreplace-flag /etc/miniascape/libvirt/networks/net-3.xml
miniascape.noarch: W: conffile-without-noreplace-flag /etc/miniascape/dnsmasq/net-3.conf
miniascape.noarch: W: conffile-without-noreplace-flag /etc/miniascape/libvirt/networks/net-1.xml
miniascape.noarch: W: conffile-without-noreplace-flag /etc/miniascape/dnsmasq/net-1.conf
miniascape.noarch: W: dangerous-command-in-%post install
miniascape.noarch: W: missing-lsb-keyword Required-Start in /etc/rc.d/init.d/miniascape-net-3
miniascape.noarch: W: missing-lsb-keyword Required-Stop in /etc/rc.d/init.d/miniascape-net-3
miniascape.noarch: W: missing-lsb-keyword Default-Stop in /etc/rc.d/init.d/miniascape-net-3
miniascape.noarch: W: service-default-enabled /etc/rc.d/init.d/miniascape-net-3
miniascape.noarch: E: incoherent-subsys /etc/rc.d/init.d/miniascape-net-3 miniascape
miniascape.noarch: W: service-default-enabled /etc/rc.d/init.d/miniascape-net-3
miniascape.noarch: W: missing-lsb-keyword Required-Start in /etc/rc.d/init.d/miniascape-net-2
miniascape.noarch: W: missing-lsb-keyword Required-Stop in /etc/rc.d/init.d/miniascape-net-2
miniascape.noarch: W: missing-lsb-keyword Default-Stop in /etc/rc.d/init.d/miniascape-net-2
miniascape.noarch: W: service-default-enabled /etc/rc.d/init.d/miniascape-net-2
miniascape.noarch: E: incoherent-subsys /etc/rc.d/init.d/miniascape-net-2 miniascape
miniascape.noarch: W: service-default-enabled /etc/rc.d/init.d/miniascape-net-2
miniascape.noarch: W: missing-lsb-keyword Required-Start in /etc/rc.d/init.d/miniascape-net-1
miniascape.noarch: W: missing-lsb-keyword Required-Stop in /etc/rc.d/init.d/miniascape-net-1
miniascape.noarch: W: missing-lsb-keyword Default-Stop in /etc/rc.d/init.d/miniascape-net-1
miniascape.noarch: W: service-default-enabled /etc/rc.d/init.d/miniascape-net-1
miniascape.noarch: E: incoherent-subsys /etc/rc.d/init.d/miniascape-net-1 miniascape
miniascape.noarch: W: service-default-enabled /etc/rc.d/init.d/miniascape-net-1
1 packages and 0 specfiles checked; 3 errors, 22 warnings.
ssato@localhost%


Completed / Done
----------------------

 * Generate dnsmasq | dhcpd and bind configs from libvirt network XML



License
====================

This is distributed under GPLv3 or later except for the Autoconf macros under
m4 subdir.

See COPYING for details about GPLv3.


Special exception m4/*.m4
----------------------------------

As a special exception, I gives unlimited permission to copy, distribute and
modify the configure scripts that are the output of Autoconf when processing
the Macro. You need not follow the terms of the GNU General Public License when
using or distributing such scripts, even though portions of the text of the
Macro appear in them. The GNU General Public License (GPL) does govern all
other use of the material that constitutes the Autoconf Macro.

This special exception to the GPL applies to the Autoconf macro under m4/
subdir only.  When you make and distribute a modified version of these Autoconf
Macro, you may extend this special exception to the GPL to apply to your
modified version as well.


Author
=======================

Satoru SATOH <satoru.satoh at gmail.com>

