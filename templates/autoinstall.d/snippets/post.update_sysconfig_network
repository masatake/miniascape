bp=/root/setup/boot-params; test -f ${bp} && source ${bp} || :
fqdn="${hostname}"    # May be defined in ${bp}.
gateway="${gateway}"  # Likewise.
test "x${fqdn}" != "x" || fqdn={{ fqdn|default('localhost.localdomain') }}
test "x${gateway}" != "x" || gateway={{ gateway|default('') }}

f=/etc/sysconfig/network
if test -f $f; then
    test -f $f.save || cp $f $f.save
    cat << EOF >> $f
HOSTNAME=${fqdn}
{{ "NOZEROCONF=yes" if kickstart.nozeroconf }}
{{ "NETWORKING_IPV6=no" if noipv6 }}
EOF
    test "x${gateway}" = "x" || echo "GATEWAY=${gateway}" >> $f
else
    f=/etc/hostname
    if test -f $f; then
        test -f $f.save || cp $f $f.save
        echo ${fqdn} > /etc/hostname
    fi
fi
