f=/etc/resolv.conf
if test -f $f; then
    test -f $f.save || cp -f $f $f.save
else
    touch $f.save  # arrange empty file to compare w/ $f
fi
cat << EOF > $f
# This file was generated during kickstart installation.
# DO NOT EDIT THIS FILE MANUALLY.
# 
# NOTE: You should set 'PEERDNS=no' in /etc/sysconfig/network-scripts/ifcfg-*.
# See also: RHEL 6 Deployment Guide, 9.2. Interface Configuration Files:
# http://red.ht/Swi6Zp
domain {{ domain }}
search {{ domain }}
EOF
{% for ns in nameservers %}echo "nameserver {{ ns.hostname }}" >> $f;{% endfor %}
cp $f $f.static  # Make a backup for cases if NetworkManager force generate it.
