{% extends "rhel-6-min-ks.cfg" %}

{% block firewall -%}
# FIXME: Which port must be opened ?
firewall --disabled
{%- endblock %}

{% block services -%}
services --enabled sshd
{%- endblock %}

{%  block partition -%}
# NOTE: VG 'vg_1' must be renamed to 'cinder-volumes' in %post as it seems that
# it cannot done in anaconda.
zerombr
clearpart --all --initlabel
part /boot --fstype=ext4 --size=200
part pv.253001 --size=20480
part pv.253002 --grow --size=1
volgroup vg_0 --pesize=4096 pv.253001
volgroup vg_1 --pesize=4096 pv.253002
logvol /    --fstype=ext4 --name=lv_root --vgname=vg_0 --size=1 --grow
logvol swap               --name=lv_swap --vgname=vg_0 --size=1024
{%- endblock %}

{% block packages_installed -%}
{{ super() }}
ntp
python-netaddr
{%   include "data/openstack/controller.required_rpms.txt" %}
{%- endblock %}

{% block post -%}
{{ super() }}
{%   include "snippets/post.update_sysconfig_network" %}
{%   include "snippets/post.update_ntp.conf" %}
# NOTE: See the above note.
vgrename vg_1 cinder-volumes
{%- endblock %}
