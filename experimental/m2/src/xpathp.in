#! @PYTHON@
#
# Evaluate given Xpath with given XML document and print result[s].
#
# Copyright (C) 2010 Satoru SATOH <satoru.satoh at gmail.com>
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3, or (at your option)
# any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software Foundation,
# Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
#

import errno
import optparse
import sys

from miniascape.utils xpath_eval



def main():
    p = optparse.OptionParser("%prog [OPTION ...] XMLFILE\nXMLFILE:  file path or '-' (read from stdin)")
    p.add_option('-x', '--xpath', help='XPath expression to get result[s]')
    (options, args) = p.parse_args()

    if not options.xpath:
        print >> sys.stderr, "You must specify Xpath expression with the option '-x' or '--xpath'"
        sys.exit(errno.EINVAL)

    if len(args) < 1:
        p.print_help()
        sys.exit(errno.EINVAL)

    xmlfile = args[0]

    if xmlfile == '-':
        xmlfile = sys.stdin

    rs = xpath_eval(options.xpath, xmlfile)

    for r in rs:
        print r


if __name__ == '__main__':
    main()


# vim:sw=4:ts=4:et:ft=python:
