# vim:sw=2:ts=2:et:

  - name: rhel-7-cluster
    description: RHEL 7 cluser nodes

    kickstart:
      repos:
        - name: "CentOS 7 x86_64"
          baseurl: http://mirror.centos.org/centos/7/os/x86_64/
        #- name: "RHEL 7 x86_64 HighAvailability"
        #  baseurl: http://binaries/contents/RHEL/7/1/x86_64/default/addons/HighAvailability/
        #- name: "RHEL 7 x86_64 ResilientStorage"
        #  baseurl: http://binaries/contents/RHEL/7/1/x86_64/default/addons/ResilientStorage/

    disks:
      - pool: default
        size: 5
        bus: scsi
      - pool: default
        vol: rhel-7-cluster-data-1.img
        size: 1
        bus: scsi

    cluster:
      nodes:
        - &rhel_7_cluster_node_1 rhel-7-cluster-default-1
        - &rhel_7_cluster_node_2 rhel-7-cluster-default-2
      resources:
        ip: 192.168.155.130

    hosts:
      - ip: 192.168.122.131
        hostname: *rhel_7_cluster_node_1
      - ip: 192.168.122.132
        hostname: *rhel_7_cluster_node_2

    virtinst:
      location: *rhel_7_location
      os_variant: rhel7
      extra_args: console=tty0 console=ttyS0,115200 net.ifnames=0 video=640x480

    templates:
      autoinst:
        src: autoinstall.d/rhel-7-cluster-ks.cfg

    setup_data:
      - src: data/rhel-7-cluster/init.sh
        dst: init.sh

    guests:
      - hostname: &rhel_7_cluster_1_hostname rhel-7-cluster-1
        fqdn: &rhel_7_cluster_1_fqdn rhel-7-cluster-1.m2.local
        ip: &rhel_7_cluster_1_ip 192.168.155.178
        interfaces:
          - network: service
            mac: "52:54:00:05:01:78"
            ip: *rhel_7_cluster_1_ip
            host: *rhel_7_cluster_1_hostname
            fqdn: *rhel_7_cluster_1_fqdn
            activate: true
          - network: default  # For Inter-cluster-nodes communication
            bootproto: static
            mac: "52:54:00:02:01:78"
            ip: *rhel_7_cluster_node_1
            host: rhel-7-cluster-default-1
            nodns: true

      - hostname: &rhel_7_cluster_2_hostname rhel-7-cluster-2
        fqdn: &rhel_7_cluster_1_fqdn rhel-7-cluster-2.m2.local
        ip: &rhel_7_cluster_1_ip 192.168.155.179
        interfaces:
          - network: service
            mac: "52:54:00:05:01:79"
            ip: *rhel_7_cluster_2_ip
            host: *rhel_7_cluster_2_hostname
            fqdn: *rhel_7_cluster_2_fqdn
            activate: true
          - network: default
            bootproto: static
            mac: "52:54:00:02:01:79"
            ip: *rhel_7_cluster_node_2
            host: rhel-7-cluster-default-2
            nodns: true


